<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.0" />






<meta name="description" content="Programer | Pythoner | Life fucker">
<meta property="og:type" content="website">
<meta property="og:title" content="remones note">
<meta property="og:url" content="http://remones.me/index.html">
<meta property="og:site_name" content="remones note">
<meta property="og:description" content="Programer | Pythoner | Life fucker">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="remones note">
<meta name="twitter:description" content="Programer | Pythoner | Life fucker">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: '[object Object]',
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> remones note </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  






  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">remones note</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">to be, or not to be</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/04/Python 的一些总结/" itemprop="url">
                  Python的一些个人总结
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-04T18:57:53+08:00" content="2016-03-04">
              2016-03-04
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>无规律的个人总结，想到什么就写什么。官方FAQ: <a href="https://docs.python.org/2/faq/programming.html">Python Programming FAQ</a></p>
<h2 id="基础类型"><a href="#基础类型" class="headerlink" title="基础类型"></a>基础类型</h2><h3 id="int"><a href="#int" class="headerlink" title="int"></a>int</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: a = <span class="number">10</span></span><br><span class="line">In [<span class="number">2</span>]: a.</span><br><span class="line">int.bit_length   int.denominator  int.imag         int.real</span><br><span class="line">int.conjugate    int.from_bytes   int.numerator    int.to_bytes</span><br></pre></td></tr></table></figure>
<p>部分方法属性：</p>
<table>
<thead>
<tr>
<th style="text-align:left">属性</th>
<th>值</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">bit_length</td>
<td>4</td>
<td>二进制位长</td>
</tr>
<tr>
<td style="text-align:left">denominator</td>
<td>1</td>
<td>分母</td>
</tr>
<tr>
<td style="text-align:left">imag</td>
<td>0</td>
<td>虚数</td>
</tr>
<tr>
<td style="text-align:left">real</td>
<td>10</td>
<td>实数</td>
</tr>
<tr>
<td style="text-align:left">conjugate</td>
<td>10</td>
<td>共轭复数</td>
</tr>
<tr>
<td style="text-align:left">numerator</td>
<td>10</td>
<td>分子</td>
</tr>
</tbody>
</table>
<p>整数池缓存：[-5, 256]对应的整数对象被缓存在一个对象中，避免频繁申请创建对象带来的开销。<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/04/Python 的一些总结/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/03/《Python源码剖析》读书笔记-Python虚拟机中的类机制/" itemprop="url">
                  《Python源码剖析》读书笔记: Python虚拟机中的类机制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-03T18:57:53+08:00" content="2016-03-03">
              2016-03-03
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="对象模型概述"><a href="#对象模型概述" class="headerlink" title="对象模型概述"></a>对象模型概述</h3><p>Python 中的对象(new class 诞生以后):</p>
<ul>
<li><code>class</code>对象: Python 中自定义类型</li>
<li><code>instance</code>对象: 由<code>class</code>对象创建的实例</li>
</ul>
<p>Python 中内置类型对象<code>int</code>, <code>str</code>本质都是<code>class</code>，在 Python2.2 之前它们是单独一套<code>type</code>类型，2.2之后类型机制重构后全部变成了<code>class</code>对象。</p>
<p>对象之间对应着两种关系:</p>
<ul>
<li>is-kind-of 关系：基类与子类的关系，子类<code>is kind of</code>基类</li>
<li>is-instance-of 关系：类与实例的关系，实例<code>is instance of</code>类</li>
</ul>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/03/《Python源码剖析》读书笔记-Python虚拟机中的类机制/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/02/Python源码剖析》读书笔记-编译与运行/" itemprop="url">
                  《Python源码剖析》读书笔记:编译与运行
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-02T01:51:27+08:00" content="2016-03-02">
              2016-03-02
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="编译期"><a href="#编译期" class="headerlink" title="编译期"></a>编译期</h2><p>Python 解释器在工作时，首先会将代码编译成字节码、字符串和常量组成的静态信息，静态信息在运行时被存储在 PyCodeObject 对象中，运行结束后会将这个对象写入到 pyc 文件中。模块被 import 说明模块需要被复用，这是触发 pyc 文件生成的条件。</p>
<h3 id="PyCodeObject"><a href="#PyCodeObject" class="headerlink" title="PyCodeObject"></a>PyCodeObject</h3><p>一个 Code Block 对应一个 PyCodeObject 对象，模块、类和函数都能产生 Code Block。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[code.h]</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> &#123;</span><br><span class="line">    PyObject_HEAD</span><br><span class="line">    <span class="keyword">int</span> co_argcount;		<span class="comment">/* #参数个数，除了 *arg 和 **kwarg */</span></span><br><span class="line">    <span class="keyword">int</span> co_kwonlyargcount;	<span class="comment">/* keyword only arguments */</span></span><br><span class="line">    <span class="keyword">int</span> co_nlocals;		<span class="comment">/* 局部变量 */</span></span><br><span class="line">    <span class="keyword">int</span> co_stacksize;		<span class="comment">/* 用来计算栈空间的*/</span></span><br><span class="line">    <span class="keyword">int</span> co_flags;		<span class="comment">/* CO_...开头的常量flag */</span></span><br><span class="line">    PyObject *co_code;		<span class="comment">/* 指令码 */</span></span><br><span class="line">    PyObject *co_consts;	<span class="comment">/* 用于存储常量 */</span></span><br><span class="line">    PyObject *co_names;		<span class="comment">/* 使用了的变量名列表，赋值(变量绑定)不算使用 */</span></span><br><span class="line">    PyObject *co_varnames;	<span class="comment">/* 存放 局部变量符号的 tuple */</span></span><br><span class="line">    PyObject *co_freevars;	<span class="comment">/* 存放自由变量名的tuple */</span></span><br><span class="line">    PyObject *co_cellvars;      <span class="comment">/* 存放cell变量名的tuple */</span></span><br><span class="line">    PyObject *co_filename; <span class="comment">/* 文件地址 */</span></span><br><span class="line">    PyObject 	*co_name;  <span class="comment">/* Code Block name, 函数就是函数名，模块就是模块名*/</span></span><br><span class="line">    <span class="keyword">int</span> co_firstlineno; <span class="comment">/* 代码初始行 */</span></span><br><span class="line">    PyObject *co_lnotab; <span class="comment">/* 指令对应的行号，存储的是与上一行的增量 */</span></span><br><span class="line">    <span class="keyword">void</span> *co_zombieframe; <span class="comment">/* 帧 */</span></span><br><span class="line">    PyObject *co_weakreflist; <span class="comment">/* 引用计数列表 */</span> </span><br><span class="line">&#125; PyCodeObject;</span><br></pre></td></tr></table></figure>
<p><code>PyMarshal_WriteObjectToFile</code>完成写入 PyCodeObject 到 pyc 文件的动作，函数内部实际调用<code>w_object</code>将 Python 代码中出现的对象和对应的<code>TYPE_*</code>标识一一存入对象，比如<code>int</code>对象对应标识<code>TYPE_INT</code>。</p>
<p>作用域及相关信息（free variables、cell variables）也是在编译时期就确定好了，并存于 PyCodeObject 当中。</p>
<p>PyCodeObject 实际上是对应了 Python 中的对象 <code>&lt;type &#39;code&#39;&gt;</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]:def <span class="function"><span class="title">foo</span><span class="params">(x, y)</span></span>:</span><br><span class="line">    ...:    print x, y</span><br><span class="line">    ...:    def <span class="function"><span class="title">bar</span><span class="params">(i, j)</span></span>:</span><br><span class="line">    ...:	     x, y = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">    ...:    return foo</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: foo<span class="class">.func_code</span>.</span><br><span class="line">foo<span class="class">.func_code</span><span class="class">.co_argcount</span>     foo<span class="class">.func_code</span><span class="class">.co_firstlineno</span>  foo<span class="class">.func_code</span><span class="class">.co_names</span></span><br><span class="line">foo<span class="class">.func_code</span><span class="class">.co_cellvars</span>     foo<span class="class">.func_code</span><span class="class">.co_flags</span>        foo<span class="class">.func_code</span><span class="class">.co_nlocals</span></span><br><span class="line">foo<span class="class">.func_code</span><span class="class">.co_code</span>         foo<span class="class">.func_code</span><span class="class">.co_freevars</span>     foo<span class="class">.func_code</span><span class="class">.co_stacksize</span></span><br><span class="line">foo<span class="class">.func_code</span><span class="class">.co_consts</span>       foo<span class="class">.func_code</span><span class="class">.co_lnotab</span>       foo<span class="class">.func_code</span><span class="class">.co_varnames</span></span><br><span class="line">foo<span class="class">.func_code</span><span class="class">.co_filename</span>     foo<span class="class">.func_code</span><span class="class">.co_name</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">15</span>]: print <span class="function"><span class="title">type</span><span class="params">(foo.func_code)</span></span></span><br><span class="line">&lt;type <span class="string">'code'</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="运行期"><a href="#运行期" class="headerlink" title="运行期"></a>运行期</h2><h3 id="执行环境"><a href="#执行环境" class="headerlink" title="执行环境"></a>执行环境</h3><p>Python在运行时，它的虚拟机实际上面对的并不是一个PyCodeObject对象，而是与之对应的帧栈对象 PyFrameObject。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[frameobject.h]</span><br><span class="line"></span><br><span class="line">typedef struct _frame &#123;</span><br><span class="line">    PyObject_VAR_HEAD</span><br><span class="line">    struct _frame <span class="keyword">*</span>f_back;      /<span class="keyword">*</span> previous frame, or NULL <span class="keyword">*</span>/</span><br><span class="line">    PyCodeObject <span class="keyword">*</span>f_code;       /<span class="keyword">*</span> code segment <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span>f_builtins;       /<span class="keyword">*</span> builtin symbol table (PyDictObject) <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span>f_globals;        /<span class="keyword">*</span> global symbol table (PyDictObject) <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span>f_locals;         /<span class="keyword">*</span> local symbol table (any mapping) <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span><span class="keyword">*</span>f_valuestack;    /<span class="keyword">*</span> points after the last local <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span><span class="keyword">*</span>f_stacktop;</span><br><span class="line">    ...</span><br><span class="line">&#125; PyFrameObject;</span><br></pre></td></tr></table></figure>
<h3 id="PyFrameObject"><a href="#PyFrameObject" class="headerlink" title="PyFrameObject"></a>PyFrameObject</h3><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[frameobject.h]</span><br><span class="line"></span><br><span class="line">typedef struct _frame &#123;</span><br><span class="line">    PyObject_VAR_HEAD</span><br><span class="line">    struct _frame <span class="keyword">*</span>f_back;      /<span class="keyword">*</span>执行环境链上的前一个frame, or NULL <span class="keyword">*</span>/</span><br><span class="line">    PyCodeObject <span class="keyword">*</span>f_code;       /<span class="keyword">*</span> PyCodeObject对象 <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span>f_builtins;       /<span class="keyword">*</span> 内置符号表（PyDictObject） <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span>f_globals;        /<span class="keyword">*</span> 全局符号表(PyDictObject) <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span>f_locals;         /<span class="keyword">*</span> 局部符号表 (any mapping) <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span><span class="keyword">*</span>f_valuestack;    /<span class="keyword">*</span> 运行时栈的栈底位置 <span class="keyword">*</span>/</span><br><span class="line">    PyObject <span class="keyword">*</span><span class="keyword">*</span>f_stacktop;      /<span class="keyword">*</span> 运行时栈的栈顶位置 <span class="keyword">*</span>/</span><br><span class="line">    ...</span><br><span class="line">    //动态内存，维护（局部变量+cell对象集合+free对象集合+运行时栈）所需要的空间</span><br><span class="line">    PyObject <span class="keyword">*</span>f_localsplus[1];</span><br><span class="line">&#125; PyFrameObject;</span><br></pre></td></tr></table></figure>
<p>PyFrameObject 除了 PyCodeObject 信息外还包含执行环境信息。执行环境包含运行时栈(程序执行所需要的内存空间)，以及名字空间(builtints locals, globals (k, v)对应变量名和变量值的PyDictObject对象指针)。</p>
<p>Python 会根据调用对象不同，产生很多帧栈对象，这些帧栈联系在一起形成调用栈(与X86的运行时栈对应)。</p>
<p>创建 PyFrameObject 过程</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[py.c]</span><br><span class="line"><span class="label">PyFrameObject</span> *</span><br><span class="line"><span class="label">PyFrame_New</span>(PyThreadState *<span class="keyword">tstate, </span>PyCodeObject *<span class="preprocessor">code</span>, PyObject *globals,</span><br><span class="line">            PyObject *locals) </span><br><span class="line">&#123;</span><br><span class="line"><span class="label">...</span></span><br><span class="line"></span><br><span class="line">	<span class="preprocessor">else</span> &#123;</span><br><span class="line">        Py_ssize_t extras, ncells, nfrees<span class="comment">;</span></span><br><span class="line">        ncells = PyTuple_GET_SIZE(<span class="preprocessor">code</span>-&gt;co_cellvars)<span class="comment">;</span></span><br><span class="line">        nfrees = PyTuple_GET_SIZE(<span class="preprocessor">code</span>-&gt;co_freevars)<span class="comment">;</span></span><br><span class="line">        extras = <span class="preprocessor">code</span>-&gt;co_stacksize + <span class="preprocessor">code</span>-&gt;co_nlocals + ncells +</span><br><span class="line">            nfrees<span class="comment">; // 动态内存区由 co_stacksize, co_nlocals,  ncells, nfrees 构成</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/01/Go语言学习笔记/" itemprop="url">
                  Go语言学习笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-01T18:00:10+08:00" content="2016-03-01">
              2016-03-01
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="1-类型"><a href="#1-类型" class="headerlink" title="1.类型"></a>1.类型</h2><h3 id="值类型"><a href="#值类型" class="headerlink" title="值类型"></a>值类型</h3><ul>
<li>基本值类型</li>
</ul>
<table>
<thead>
<tr>
<th>类型</th>
<th style="text-align:center">长度</th>
<th>默认值</th>
</tr>
</thead>
<tbody>
<tr>
<td>bool</td>
<td style="text-align:center">1</td>
<td>false</td>
</tr>
<tr>
<td>byte</td>
<td style="text-align:center">1</td>
<td>0</td>
</tr>
<tr>
<td>rune</td>
<td style="text-align:center">4</td>
<td>0</td>
</tr>
<tr>
<td>int, uint</td>
<td style="text-align:center">4 or 8</td>
<td>0</td>
</tr>
<tr>
<td>int8, uint8</td>
<td style="text-align:center">1</td>
<td>0         </td>
</tr>
<tr>
<td>int16,uint16</td>
<td style="text-align:center">2</td>
<td>0</td>
</tr>
<tr>
<td>int32,uint32</td>
<td style="text-align:center">4</td>
<td>0</td>
</tr>
<tr>
<td>int64,uint64</td>
<td style="text-align:center">8</td>
<td>0</td>
</tr>
<tr>
<td>float32</td>
<td style="text-align:center">4</td>
<td>0.0</td>
</tr>
<tr>
<td>float64</td>
<td style="text-align:center">8</td>
<td>0.0</td>
</tr>
<tr>
<td>complex64</td>
<td style="text-align:center">8</td>
<td>-</td>
</tr>
<tr>
<td>complex128</td>
<td style="text-align:center">16</td>
<td>-</td>
</tr>
<tr>
<td>uintptr</td>
<td style="text-align:center">4 or 8</td>
<td>-</td>
</tr>
<tr>
<td>string</td>
<td style="text-align:center">-</td>
<td>“”</td>
</tr>
</tbody>
</table>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/01/Go语言学习笔记/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/28/Tornado源码分析-三-stack-context/" itemprop="url">
                  Tornado源码分析(三): stack_context
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-28T23:32:21+08:00" content="2016-02-28">
              2016-02-28
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p><code>Tornado</code>里<code>stack_context</code>模块是用于解决异步函数调用时上下文不一致的问题的。</p>
<p>在异步程序里，像下面这样是无法捕捉到<code>cb_func</code>中发生的异常的。<code>async_func</code>调用时只是注册了<code>callback</code>，等有结果返回时才会触发回调的执行，而那时回调函数和<code>async_func</code>早已不在同一个上下文了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    async_func(args, callback=cb_func)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    do_something_catch()</span><br></pre></td></tr></table></figure>
<h3 id="StackContext"><a href="#StackContext" class="headerlink" title="StackContext"></a>StackContext</h3><p>如果要保证<code>async_func</code>和<code>callback</code>执行时采用一致的异常处理方式，借助Python标准库中<code>contextlib.contextmanager</code>，让<code>async_func</code>和<code>callback</code>在执行时进入同一个<code>contextlib.contextmanager</code>生成的上下文中就可以做到。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/02/28/Tornado源码分析-三-stack-context/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/28/前端总结之CSS基础篇/" itemprop="url">
                  前端总结之CSS基础篇
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-28T15:22:44+08:00" content="2016-02-28">
              2016-02-28
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="盒模型"><a href="#盒模型" class="headerlink" title="盒模型"></a>盒模型</h3><p>元素是 HTML 文档结构基础，如 <code>p</code>、<code>div</code>。每个元素都会对文档表现一定作用，意味着每个元素生成一个矩形的框(box，也叫盒模型)，盒模型总共由3种框构成。</p>
<ul>
<li>margin-edge: 外边框 (margin，确定外延位置)</li>
<li>border-edge: 边框 (border，确定边框)</li>
<li>padding-edge: 内边框 (padiding，框内包含的填充元素)</li>
</ul>
<p>margin-edge 到 border 的距离叫外边距，padding-edge 到 border-edge 的距离叫内边距。</p>
<p><img src="/img/2016-2-28-1.gif" alt="gege"></p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/02/28/前端总结之CSS基础篇/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/23/Tornado源码分析-二-ioloop/" itemprop="url">
                  Tornado源码分析(二): ioloop
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-23T21:40:31+08:00" content="2016-02-23">
              2016-02-23
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p>在剖析 ioloop 的实现代码之前，有一些 I/O 中常出现的概念需要清楚。简单复习和归纳一下几个名词的含义。</p>
<h4 id="同步和异步"><a href="#同步和异步" class="headerlink" title="同步和异步"></a>同步和异步</h4><p>同步和异步的区别表现在程序执行的方式上。同步可以理解为顺序执行，一件事干完了才能继续另一件事，这个不多说了，主要是对异步的理解。</p>
<p>举个例子，如果你想发送一封邮件, 首先你需要这样做</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mail_client = smtp.connect() <span class="comment"># 和邮件服务端建立连接</span></span><br><span class="line">mail_client.send_mail(mailto) <span class="comment"># 发送邮件</span></span><br><span class="line">do_otherthing()</span><br></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/02/23/Tornado源码分析-二-ioloop/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/22/Tornado源码分析-一-gen/" itemprop="url">
                  Tornado源码分析(一): gen
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-22T02:49:39+08:00" content="2016-02-22">
              2016-02-22
            </time>
          </span>

          

          
            
          

          

          
          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><p>Tornado 几乎是 Python 关于异步必会提及的框架，在公司负责的业务虽然很少用到，不过 Tornado 以精巧简洁的设计和十分优异的性能著称，对它是如何实现的也感到很好奇，在自己阅读几遍源码之后也试着整理思路简单分析一下。</p>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>先从一个简单的例子开始:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> tornado.ioloop <span class="keyword">import</span> IOLoop</span><br><span class="line"><span class="keyword">from</span> tornado <span class="keyword">import</span> gen</span><br><span class="line"><span class="keyword">from</span> tornado.httpclient <span class="keyword">import</span> AsyncHTTPClient</span><br><span class="line"></span><br><span class="line"><span class="decorator">@gen.coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch_url</span><span class="params">(url)</span>:</span></span><br><span class="line">    http_client = AsyncHTTPClient()</span><br><span class="line">    response = <span class="keyword">yield</span> http_client.fetch(url)</span><br><span class="line">    <span class="keyword">raise</span> gen.Return(response.body)</span><br><span class="line">    </span><br><span class="line"><span class="decorator">@gen.coroutine</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'http://httpbin.org/get'</span></span><br><span class="line">    content = <span class="keyword">yield</span> fetch_url(url)</span><br><span class="line">    print(content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    ioloop = IOLoop.instance()</span><br><span class="line">    ioloop.run_sync(main)</span><br></pre></td></tr></table></figure>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/02/22/Tornado源码分析-一-gen/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://ww3.sinaimg.cn/large/8eb3c606jw8e30umhfk5kj.jpg"
               alt="remones" />
          <p class="site-author-name" itemprop="name">remones</p>
          <p class="site-description motion-element" itemprop="description">Programer | Pythoner | Life fucker</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">8</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分类</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">7</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">remones</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  


  



  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.0"></script>



  



  



  
  

  
  


</body>
</html>
